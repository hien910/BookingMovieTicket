<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<style>

</style>
<body>

<header th:fragment="header">
    <nav class="navbar navbar-expand-lg bg-dark d-flex flex-column" style="background-image: url('/image/bg6.jpg'); /* Đường dẫn đến ảnh của bạn */
                                                                              background-size: cover; /* Hiển thị ảnh theo kích thước cover của thẻ */
                                                                              background-position: bottom; /* Căn chỉnh ảnh vào giữa */">
        <div class="container justify-content-between">
            <div style="display: flex">
                <div>
                    <a class="navbar-brand" th:href="@{/}">
                        <img src="/image/logoCinema.png" alt="" style="height: 80px; width: 210px;">
                    </a>
                </div>

            </div>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false"
                    aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse " id="navbarNavAltMarkup" style="justify-content:flex-end ">
                <div class="navbar-nav">

                    <a class="nav-link text-white fs-5" th:href="@{/lich-chieu}"><b>Lịch chiếu</b></a>
                    <a class="nav-link text-white fs-5" th:href="@{/rap-chieu}"><b>Rạp chiếu</b></a>
                    <a class="nav-link text-white fs-5" th:href="@{/phim-chieu}"><b>Phim chiếu</b></a>
                    <a class="nav-link text-white fs-5" th:href="@{/list-blog}"><b>Tin tức</b></a>
                </div>
                <div id="advc1-menu" class="search" style="padding-left: 20px">
                    <form method="get" id="searchform" action="">
                        <input type="text" placeholder=" Tìm kiếm phim..." style="width: 350px; height: 50px; border-radius: 25px;">
                        <button class="search-button" type="submit" style="width: 50px; height: 50px; border-radius: 25px;">
                            <i class="bi bi-search" style="font-size: large"></i>
                        </button>
                    </form>
                </div>


                <div style="padding-left: 50px">
                    <div>
                        <th:block th:if="${session.currentUser == null}">
                            <a class="text-white" href="/dang-nhap">Log in</a>
                        </th:block>
                        <th:block th:if="${session.currentUser != null}">
                            <p class="text-white mb-0 " th:text="${session.currentUser.name}"></p>
                        </th:block>
                    </div>
                </div>
                <div style="padding-left: 25px"><i class="bi bi-person-circle" style="color: azure ;font-size: 30px;"></i>
                </div>
                <div th:if="${session.currentUser != null}">
                    <form id="logoutForm" method="post" action="/">
                        <button type="submit"> Log out</button>
                    </form>
                </div>
            </div>
        </div>
    </nav>
    <script>
        const formLogout = document.getElementById('logoutForm');

        formLogout.addEventListener("submit", (e) => {
            e.preventDefault();

            // Send logout request to server using axios
            axios.post('/api/auth/logout')
                .then((response) => {
                    console.log(response);  // In ra phản hồi từ máy chủ
                    if (response.status === 200) {
                        toastr.success("Đăng xuất thành công");
                        setTimeout(() => {
                            window.location.href = '/';  // Chuyển hướng về trang đăng nhập hoặc trang chính
                        }, 1500);
                    }
                })
                .catch((error) => {
                    console.log(error);
                    console.log(error.response.data.message);
                });
        });
    </script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</header>
</body>
</html>